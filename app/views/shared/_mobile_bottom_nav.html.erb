<!-- Mobile Bottom Navigation for Turbo Native Apps -->
<% if turbo_native_app? %>
  <nav class="fixed bottom-0 left-0 right-0 z-50 bg-slate-950/95 border-t border-white/10 backdrop-blur">
    <div class="flex justify-around items-center h-16 px-2">
      <!-- Dashboard -->
      <% if current_page?(root_path) %>
        <%= link_to root_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-primary", data: { turbo: false } do %>
          <span class="material-icons text-2xl">space_dashboard</span>
          <span class="text-xs mt-1 font-medium">Dashboard</span>
        <% end %>
      <% else %>
        <%= link_to root_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-slate-300 hover:text-yellow-300 transition-colors", data: { turbo: false } do %>
          <span class="material-icons-outlined text-2xl">space_dashboard</span>
          <span class="text-xs mt-1">Dashboard</span>
        <% end %>
      <% end %>

      <!-- Customers -->
      <% if current_page?(customers_path) %>
        <%= link_to customers_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-primary", data: { turbo: false } do %>
          <span class="material-icons text-2xl">people</span>
          <span class="text-xs mt-1 font-medium">Customers</span>
        <% end %>
      <% else %>
        <%= link_to customers_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-slate-300 hover:text-yellow-300 transition-colors", data: { turbo: false } do %>
          <span class="material-icons-outlined text-2xl">people</span>
          <span class="text-xs mt-1">Customers</span>
        <% end %>
      <% end %>

      <!-- Tasks -->
      <% if current_page?(tasks_path) %>
        <%= link_to tasks_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-primary", data: { turbo: false } do %>
          <span class="material-icons text-2xl">task</span>
          <span class="text-xs mt-1 font-medium">Tasks</span>
        <% end %>
      <% else %>
        <%= link_to tasks_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-slate-300 hover:text-yellow-300 transition-colors", data: { turbo: false } do %>
          <span class="material-icons-outlined text-2xl">task</span>
          <span class="text-xs mt-1">Tasks</span>
        <% end %>
      <% end %>

      <% if current_user&.manager? %>
        <!-- Payments (for managers) -->
        <% if current_page?(payments_path) %>
          <%= link_to payments_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-primary", data: { turbo: false } do %>
            <span class="material-icons text-2xl">payment</span>
            <span class="text-xs mt-1 font-medium">Payments</span>
          <% end %>
        <% else %>
          <%= link_to payments_path, class: "flex flex-col items-center justify-center flex-1 py-2 text-slate-300 hover:text-yellow-300 transition-colors", data: { turbo: false } do %>
            <span class="material-icons-outlined text-2xl">payment</span>
            <span class="text-xs mt-1">Payments</span>
          <% end %>
        <% end %>
      <% end %>

      <!-- Menu (opens modal with more options) -->
      <%= button_tag type: "button", 
          class: "flex flex-col items-center justify-center flex-1 py-2 text-slate-300 hover:text-yellow-300 transition-colors",
          data: { 
            controller: "mobile-menu",
            action: "click->mobile-menu#toggle"
          } do %>
        <span class="material-icons-outlined text-2xl">menu</span>
        <span class="text-xs mt-1">More</span>
      <% end %>
    </div>
  </nav>

  <!-- Mobile Menu Modal -->
  <div data-mobile-menu-target="modal" 
       class="hidden fixed inset-0 z-9999 bg-black bg-opacity-50"
       data-action="click->mobile-menu#close">
    <div class="absolute bottom-0 left-0 right-0 bg-slate-950/95 rounded-t-2xl max-h-[80vh] overflow-y-auto border-t border-white/10 backdrop-blur"
         data-action="click->mobile-menu#stopPropagation">
      <!-- Modal Header -->
      <div class="sticky top-0 bg-slate-950/95 border-b border-white/10 px-6 py-4 flex justify-between items-center backdrop-blur">
        <h3 class="text-lg font-semibold text-white">Menu</h3>
        <%= button_tag type: "button",
            class: "text-slate-300 hover:text-white",
            data: { action: "click->mobile-menu#close" } do %>
          <span class="material-icons text-2xl">close</span>
        <% end %>
      </div>

      <!-- Menu Content -->
      <div class="px-4 py-6">
        <ul class="space-y-2">
          <% if current_user&.admin? %>
            <li class="mb-4">
              <div class="px-4 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">Admin</div>
            </li>
            <li>
              <%= link_to carriers_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">local_shipping</span>
                <span class="font-medium">Carriers</span>
              <% end %>
            </li>
            <li>
              <%= link_to admin_senders_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">send</span>
                <span class="font-medium">Senders</span>
              <% end %>
            </li>
            <li>
              <%= link_to admin_messengers_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">pedal_bike</span>
                <span class="font-medium">Messengers</span>
              <% end %>
            </li>
            <li>
              <%= link_to admin_lawyers_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">gavel</span>
                <span class="font-medium">Lawyers</span>
              <% end %>
            </li>
            <li>
              <%= link_to admin_document_templates_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">description</span>
                <span class="font-medium">Document Templates</span>
              <% end %>
            </li>
            <li>
              <%= link_to admin_branding_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">brush</span>
                <span class="font-medium">Branding</span>
              <% end %>
            </li>
            <%# Admin Dashboard link removed as it is redundant with the main Dashboard %>
            <li>
              <%= link_to new_admin_pdfs_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
                <span class="material-icons text-xl">picture_as_pdf</span>
                <span class="font-medium">PDF Tools</span>
              <% end %>
            </li>
            <li class="my-4 border-t border-white/10"></li>
          <% end %>

          <li class="mb-2">
            <div class="px-4 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">Account</div>
          </li>
          <li>
            <%= link_to profile_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
              <span class="material-icons text-xl">person</span>
              <span class="font-medium">Profile</span>
            <% end %>
          </li>
          <li>
            <%= link_to settings_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-slate-200 hover:bg-white/5 hover:text-yellow-300 transition-colors" do %>
              <span class="material-icons text-xl">settings</span>
              <span class="font-medium">Settings</span>
            <% end %>
          </li>
          <li class="mt-4">
            <%= button_to destroy_user_session_path, method: :delete, class: "flex items-center gap-3 px-4 py-3 rounded-lg text-red-300 hover:bg-red-500/10 transition-colors w-full text-left" do %>
              <span class="material-icons text-xl">logout</span>
              <span class="font-medium">Sign Out</span>
            <% end %>
          </li>
        </ul>
      </div>
    </div>
  </div>
<% end %>
