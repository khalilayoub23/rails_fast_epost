<%= turbo_frame_tag task do %>
  <tr class="border-b border-white/10 hover:bg-white/5 transition-colors">
    <td class="px-4 py-4">
      <%= link_to task_path(task), class: "text-sm font-semibold text-yellow-300 hover:underline" do %>
        <%= task.barcode.presence || "##{task.id}" %>
      <% end %>

      <% if task.package_type.present? %>
        <div class="mt-1 text-xs text-slate-400">
          <%= task.package_type %>
        </div>
      <% end %>
    </td>
    <td class="px-4 py-4">
      <%= render "shared/status_badge", status: task.status %>
    </td>
    <td class="px-4 py-4">
        <%= render "shared/priority_badge", priority: task.priority %>
    </td>
    <td class="px-4 py-4 text-sm text-slate-200">
      <%= task.customer&.name || "-" %>
    </td>
    <td class="px-4 py-4 text-sm text-slate-300">
      <%= task.carrier&.name || (task.carrier_id.present? ? "##{task.carrier_id}" : "-") %>
    </td>
    <td class="px-4 py-4 text-sm text-slate-300">
      <%= l(task.created_at, format: :short) %>
    </td>
    <td class="px-4 py-4 text-right">
      <div class="flex items-center justify-end gap-3">
        <% if (current_user&.manager? || current_user&.sender_role? || current_user&.lawyer? || current_user&.ecommerce_seller?) && task.published? == false %>
          <%= button_to add_item_cart_path(task_id: task.id),
              method: :post,
              form: { data: { turbo_frame: "_top" } },
              class: "text-amber-300 hover:text-amber-200",
              title: t('cart.add_to_cart', default: 'Add to cart') do %>
            <span class="material-icons text-xl">add_shopping_cart</span>
          <% end %>
        <% end %>

        <!-- Quick status update buttons -->
        <% if task.status != "delivered" %>
          <%= button_to update_status_task_path(task, status: "in_progress"),
              method: :patch,
              class: "text-success hover:text-success/80",
              title: t('tasks.mark_in_progress'),
              data: { turbo_frame: dom_id(task) } do %>
            <span class="material-icons text-xl">play_arrow</span>
          <% end %>
        <% end %>
        
        <%= link_to task_path(task),
            class: "text-primary hover:text-primary/80",
            title: t('common.view') do %>
          <span class="material-icons text-xl">visibility</span>
        <% end %>
        
        <%= link_to edit_task_path(task),
            data: { turbo_frame: dom_id(task) },
            class: "text-warning hover:text-warning/80",
            title: t('common.edit') do %>
          <span class="material-icons text-xl">edit</span>
        <% end %>
        
        <%= button_to task_path(task),
            method: :delete,
            form: { data: { turbo_confirm: t('common.confirm_delete') } },
            class: "text-danger hover:text-danger/80",
            title: t('common.delete') do %>
          <span class="material-icons text-xl">delete</span>
        <% end %>
      </div>
    </td>
  </tr>
<% end %>
